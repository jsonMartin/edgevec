# W7D35 - Resilience Testing

## 1. Context
- **Objective:** Validate the system against adversarial conditions (Chaos Engineering).
- **Dependencies:** Full Persistence Layer (WAL + Snapshots).
- **Success Criteria:** System recovers or fails gracefully (no UB, no silent data loss) under stress.

## 2. Technical Plan

### 2.1 Chaos Scenarios
1. **Truncated File:** Append random bytes to WAL, then cut it short.
2. **Bit Rot:** Flip random bits in the WAL/Snapshot.
3. **Missing Files:** Delete WAL or Snapshot independently.

### 2.2 Fuzzing Target
Create a `cargo-fuzz` target `recovery_fuzz`:
- Input: Random byte sequence.
- Action: Treat input as a WAL file. Try to `replay()`.
- Assert: No Panic. Result is either `Ok` (valid subset) or `Err` (corruption).

### 2.3 Property Tests
`proptest!` for Roundtrip:
- Generate random Vector ops.
- Persist.
- Corrupt specific byte ranges.
- Assert `replay` detects corruption.

## 3. Tasks (W7.5)
- [ ] Implement `recovery_fuzz` target.
- [ ] Implement `test_wal_corruption_resilience` property test.
- [ ] Validate "Recovery Time" constraint (benchmarking recovery of 100k vectors).

## 4. Verification
- **Fuzzing:** Run for >1 hour.
- **Benchmark:** Report recovery time metrics.

