# v0.5.0 Strategic Roadmap

**Version:** 0.5.0
**Created:** 2025-12-16
**Status:** APPROVED BY HOSTILE_REVIEWER
**Authority:** This document is BINDING for PLANNER after Week 20 execution

---

## Executive Summary

v0.5.0 will deliver **three critical features** to address external review feedback and unblock production RAG use cases:

1. **ARM/NEON SIMD** — Mobile platform performance (Week 20)
2. **Metadata Storage API** — Store key-value data with vectors (Week 21)
3. **Filtering API** — WHERE clause support for search (Weeks 22-23)

---

## Approved Timeline

```
┌──────────────────────────────────────────────────────────────────────┐
│                    v0.5.0 DEVELOPMENT TIMELINE                       │
│                    (HOSTILE_REVIEWER APPROVED)                       │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  WEEK 20: ARM/NEON SIMD SPRINT                                       │
│  ├── Status: APPROVED (GATE_W20_PLANNING_COMPLETE.md)                │
│  ├── Focus: NEON SIMD implementations                                │
│  ├── Deliverables:                                                   │
│  │   ├── src/simd/neon.rs (hamming, dot, euclidean)                  │
│  │   ├── ARM CI verification                                         │
│  │   └── Performance benchmarks                                      │
│  └── Gate: GATE_W20_COMPLETE.md                                      │
│           │                                                          │
│           ▼                                                          │
│  WEEK 21: METADATA API + MOBILE TESTING                              │
│  ├── Priority: P0 CRITICAL                                           │
│  ├── Budget: 40 hours                                                │
│  ├── Deliverables:                                                   │
│  │   ├── Metadata storage API (24h)                                  │
│  │   │   ├── VectorId → HashMap<String, String> mapping              │
│  │   │   ├── Insert/update/delete metadata                           │
│  │   │   ├── Retrieve metadata for vectors                           │
│  │   │   ├── WASM bindings                                           │
│  │   │   └── Full test coverage                                      │
│  │   ├── Mobile browser testing (8h)                                 │
│  │   └── BrowserStack integration (8h)                               │
│  ├── Gate: GATE_W21_COMPLETE.md                                      │
│  └── CRITICAL: Metadata schema FROZEN after this week                │
│           │                                                          │
│           ▼                                                          │
│  WEEK 22: FILTERING ARCHITECTURE (DESIGN SPRINT)                     │
│  ├── Priority: P0 CRITICAL                                           │
│  ├── Budget: 16h design + 24h other work                             │
│  ├── Prerequisite: GATE_W21_COMPLETE.md exists                       │
│  ├── Deliverables:                                                   │
│  │   ├── docs/architecture/FILTERING_API.md                          │
│  │   ├── Query syntax specification (EBNF grammar)                   │
│  │   ├── Filter evaluator design                                     │
│  │   ├── Pre-filter vs post-filter strategy decision                 │
│  │   ├── Performance budget validation (<10ms with filtering)        │
│  │   ├── WASM boundary specification                                 │
│  │   └── Test strategy document                                      │
│  ├── Gate: /review approval of FILTERING_API.md                      │
│  └── NO IMPLEMENTATION — Design only                                 │
│           │                                                          │
│           ▼                                                          │
│  WEEK 23: FILTERING IMPLEMENTATION                                   │
│  ├── Priority: P0 CRITICAL                                           │
│  ├── Budget: 60h (may extend into Week 24)                           │
│  ├── Prerequisite: FILTERING_API.md approved by HOSTILE_REVIEWER     │
│  ├── Deliverables:                                                   │
│  │   ├── Query parser (12h)                                          │
│  │   ├── Filter evaluator (12h)                                      │
│  │   ├── Search integration (9h)                                     │
│  │   ├── WASM bindings (6h)                                          │
│  │   ├── Unit tests (9h)                                             │
│  │   ├── Property tests (6h)                                         │
│  │   └── Documentation (6h)                                          │
│  └── Gate: GATE_W23_COMPLETE.md                                      │
│           │                                                          │
│           ▼                                                          │
│  WEEK 24: v0.5.0 RELEASE PREP                                        │
│  ├── Deliverables:                                                   │
│  │   ├── CHANGELOG.md update                                         │
│  │   ├── README.md update (metadata + filtering docs)                │
│  │   ├── npm publish                                                 │
│  │   ├── crates.io publish                                           │
│  │   └── Release announcement                                        │
│  └── Gate: v0.5.0 RELEASED                                           │
│                                                                      │
└──────────────────────────────────────────────────────────────────────┘
```

---

## Strategic Rationale

### Why This Order?

1. **NEON SIMD (Week 20)** — Already planned, ARM CI infrastructure exists
2. **Metadata API (Week 21)** — Foundation for filtering; filtering cannot exist without metadata
3. **Filtering Architecture (Week 22)** — Design sprint ensures quality; no rushing implementation
4. **Filtering Implementation (Week 23)** — Build on stable metadata, approved architecture

### Why Phased Filtering?

The original proposal to add filtering to Week 21 was **REJECTED** because:

| Issue | Detail |
|:------|:-------|
| **Capacity overflow** | 106h proposed vs 40h available |
| **No architecture** | Query syntax undefined |
| **Dependency risk** | Filtering requires stable metadata |
| **Quality risk** | Rushed implementation = bugs |

The phased approach delivers the **same features** with **production quality**.

---

## External Review Response

This roadmap directly addresses the v0.4.0 external review criticisms:

| Criticism | Response | Week |
|:----------|:---------|:-----|
| "Missing metadata storage" | METADATA_API | Week 21 |
| "No filtering" | FILTERING_API | Weeks 22-23 |
| "Database lie" | Both features make it a real database | v0.5.0 |
| "Loading bottleneck" | Web Worker documentation | Week 21 |

---

## Constraints

### Week 21 Constraints

- **Metadata schema MUST be frozen** after Week 21
- Any schema changes after freeze require major version bump
- Filtering depends on this frozen schema

### Week 22 Constraints

- **NO implementation code** — Design only
- Architecture document MUST pass hostile review
- Query syntax MUST be formally specified
- Performance budget MUST be validated

### Week 23 Constraints

- **CANNOT start without approved architecture**
- All tasks must be <16 hours
- 100% test coverage required
- Performance regression = rejection

---

## PLANNER Instructions

After Week 20 execution completes:

### For Week 21 Planning (`/planner-weekly 21`):

```markdown
Week 21 Theme: Metadata API + Mobile Testing

MANDATORY SCOPE:
1. METADATA_API (24h) — P0 CRITICAL
   - VectorId → HashMap<String, String> storage
   - Insert/update/delete/retrieve operations
   - WASM bindings with TypeScript types
   - Full test coverage (unit + integration)
   - Documentation

2. Mobile Browser Testing (8h)
   - iOS Safari verification
   - Android Chrome verification
   - Document any limitations

3. BrowserStack Integration (8h)
   - CI integration
   - Automated mobile testing

CRITICAL OUTPUT:
- GATE_W21_COMPLETE.md
- Metadata schema documentation (FROZEN after approval)
```

### For Week 22 Planning (`/planner-weekly 22`):

```markdown
Week 22 Theme: Filtering Architecture Design Sprint

PREREQUISITE: GATE_W21_COMPLETE.md must exist

MANDATORY SCOPE:
1. FILTERING_API Architecture (16h) — P0 CRITICAL
   - Run /architect-design filtering_api
   - Define query syntax (EBNF grammar)
   - Design filter evaluator
   - Decide pre-filter vs post-filter strategy
   - Validate performance budget
   - Specify WASM boundary
   - Define test strategy

2. Other work (24h) — As needed

CRITICAL OUTPUT:
- docs/architecture/FILTERING_API.md (HOSTILE approved)
- NO implementation code
```

### For Week 23 Planning (`/planner-weekly 23`):

```markdown
Week 23 Theme: Filtering Implementation

PREREQUISITE: FILTERING_API.md approved by HOSTILE_REVIEWER

MANDATORY SCOPE:
1. Query Parser (12h)
2. Filter Evaluator (12h)
3. Search Integration (9h)
4. WASM Bindings (6h)
5. Unit Tests (9h)
6. Property Tests (6h)
7. Documentation (6h)

Total: 60h (may extend into Week 24)

CRITICAL OUTPUT:
- Full filtering API with tests
- GATE_W23_COMPLETE.md
```

---

## Success Criteria for v0.5.0

v0.5.0 is **READY FOR RELEASE** when:

- [ ] Week 20 NEON SIMD complete (GATE_W20_COMPLETE.md)
- [ ] Week 21 Metadata API complete (GATE_W21_COMPLETE.md)
- [ ] Week 22 Filtering architecture approved
- [ ] Week 23 Filtering implementation complete (GATE_W23_COMPLETE.md)
- [ ] All tests pass (unit, integration, property)
- [ ] Performance budgets met (<10ms search with filtering at 100k vectors)
- [ ] Documentation complete (README, API docs, migration guide)
- [ ] HOSTILE_REVIEWER grants final approval

---

## Revision History

| Version | Date | Change |
|:--------|:-----|:-------|
| 1.0.0 | 2025-12-16 | Initial v0.5.0 roadmap with phased filtering approach |

---

**PLANNER:** This document is BINDING. Follow the timeline and constraints exactly.
**HOSTILE_REVIEWER:** All gates require hostile review before proceeding.
**Status:** APPROVED

---

*"Metadata first. Architecture second. Implementation last. Quality always."*
